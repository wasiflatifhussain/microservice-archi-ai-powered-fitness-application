# AI Service

The AI Service is a microservice designed to provide artificial intelligence capabilities within an application. It
offers functionalities such as natural language processing, machine learning model inference, and data analysis. The
service is built using a modular architecture to ensure scalability and maintainability.

## Rabbit MQ Integration

Listens to a Rabbit MQ queue for incoming requests and processes them using AI models. The activities are generated by
Activity Service and broadcast to the Rabbit MQ queue. Then, the AI Service listens to the queue and processes the
activities.

Since we are using Gemini API in Hong Kong, we need to set up a VPN connection to access the API.  
Due to this, and due to AI cost limitations, we need to setup failure and retry mechanisms.  
We use Retryable to handle retries in case of failures when calling the Gemini API.

The flow:
Message arrives → processActivity() called  
↓  
generateRecommendation() attempt 1 (immediate)  
↓ (if fails)  
Wait 1 second → generateRecommendation() attempt 2  
↓ (if fails)  
Wait 2 seconds → generateRecommendation() attempt 3  
↓ (if fails)  
@Recover method → throws RecommendationGenerationException  
↓  
Caught in processActivity() → AmqpRejectAndDontRequeueException  
↓  
Message discarded (not requeued)

**In current Setup:  
Message arrives → 3 retry attempts → Failure → Message DELETED forever  
Server restart → Message is gone, won't process again**

**NOTE: Must run VPN to access Gemini API.**  